clc
clear all
close all
warning off all

%% load the data
load ccv_n1;
load ccv_n2;
load ccv_n3; 
load ccv_n4; 
load ccv_n5; 
load ccv_n6; 
load ccv_n7; 
load ccv_n8; 
load ccv_n9; 
load ccv_n10;
load ccv_n11;
load ccv_n12;
load ccv_n13;
load ccv_n14;
load ccv_n15;
load ccv_n16;
load ccv_n17;
load ccv_n18;
load ccv_n19;
load ccv_n20;
load ccv_n21;
load ccv_n22;
load ccv_n23;
load ccv_n24;
load ccv_n25;
load ccv_n26;
load ccv_n27;
load ccv_n28;
load ccv_n29;
load ccv_n30;
load ccv_n31;
load ccv_n32;
load ccv_n33;
load ccv_n34;
load ccv_n35;
load ccv_n36;
load ccv_n37;
load ccv_n38;
load ccv_n39;
load ccv_n40;
load ccv_n41;
load ccv_n42;
load ccv_n43;
load ccv_n44;
load ccv_n45;
load ccv_n46;
load ccv_n47;
load ccv_n48;
load ccv_n49;
load ccv_n50;
load ccv_n51;
load ccv_n52;
load ccv_n53;
load ccv_n54;
load ccv_n55;
load ccv_n56;
load ccv_n57;
load ccv_n58;
load ccv_n59;
load ccv_n60;
load ccv_n61;
load ccv_n62;
load ccv_n63;
load ccv_n64;
load ccv_n65;
load ccv_n66;
load ccv_n67;
load ccv_n68;
load ccv_n69;
load ccv_n70;
load ccv_n71;
load ccv_n72;
load ccv_n73;
load ccv_n74;
load ccv_n75;
load ccv_n76;
load ccv_n77;
load ccv_n78;
load ccv_n79;

load ccv_b1;  
load ccv_b2;  
load ccv_b3;  
load ccv_b4;  
load ccv_b5;  
load ccv_b6;  
load ccv_b7;  
load ccv_b8;  
load ccv_b9;  
load ccv_b10; 
load ccv_b11; 
load ccv_b12; 
load ccv_b13; 
load ccv_b14; 
load ccv_b15; 
load ccv_b16; 
load ccv_b17; 
load ccv_b18; 
load ccv_b19; 
load ccv_b20; 
load ccv_b21; 
load ccv_b22; 
load ccv_b23; 
load ccv_b24; 
load ccv_b25; 
load ccv_b26; 
load ccv_b27; 
load ccv_b28; 
load ccv_b29; 
load ccv_b30; 
load ccv_b31; 
load ccv_b32; 
load ccv_b33; 
load ccv_b34; 
load ccv_b35; 
load ccv_b36; 
load ccv_b37; 
load ccv_b38; 
load ccv_b39; 
load ccv_b40; 
load ccv_b41; 
load ccv_b42; 
load ccv_b43; 
load ccv_b44; 
load ccv_b45; 
load ccv_b46; 
load ccv_b47; 
load ccv_b48; 
load ccv_b49; 
load ccv_b50; 
load ccv_b51; 
load ccv_b52; 
load ccv_b53; 
load ccv_b54; 
load ccv_b55; 
load ccv_b56; 
load ccv_b57; 
load ccv_b58; 
load ccv_b59; 
load ccv_b60; 
load ccv_b61; 
load ccv_b62; 
load ccv_b63; 
load ccv_b64; 
load ccv_b65; 
load ccv_b66; 
load ccv_b67; 
load ccv_b68; 
load ccv_b69; 
load ccv_b70; 
load ccv_b71; 
load ccv_b72; 
load ccv_b73; 
load ccv_b74; 
load ccv_b75; 
load ccv_b76; 
load ccv_b77; 
load ccv_b78; 
load ccv_b79; 
load ccv_b80; 
load ccv_b81; 
load ccv_b82; 
load ccv_b83; 
load ccv_b84; 
load ccv_b85; 
load ccv_b86; 
load ccv_b87; 
load ccv_b88; 
load ccv_b89; 
load ccv_b90; 
load ccv_b91; 
load ccv_b92; 
load ccv_b93; 
load ccv_b94; 
load ccv_b95; 
load ccv_b96; 
load ccv_b97; 
load ccv_b98; 
load ccv_b99; 
load ccv_b100;
load ccv_b101;
load ccv_b102;
load ccv_b103;
load ccv_b104;
load ccv_b105;
load ccv_b106;
load ccv_b107;
load ccv_b108;
load ccv_b109;
load ccv_b110;
load ccv_b111;
load ccv_b112;
load ccv_b113;
load ccv_b114;
load ccv_b115;
load ccv_b116;
load ccv_b117;
load ccv_b118;
load ccv_b119;
load ccv_b120;
load ccv_b121;

load ccv_r1;  
load ccv_r2;  
load ccv_r3;  
load ccv_r4;  
load ccv_r5;  
load ccv_r6;  
load ccv_r7;  
load ccv_r8;  
load ccv_r9;  
load ccv_r10; 
load ccv_r11; 
load ccv_r12; 
load ccv_r13; 
load ccv_r14; 
load ccv_r15; 
load ccv_r16; 
load ccv_r17; 
load ccv_r18; 
load ccv_r19; 
load ccv_r20; 
load ccv_r21; 
load ccv_r22; 
load ccv_r23; 
load ccv_r24; 
load ccv_r25; 
load ccv_r26; 
load ccv_r27; 
load ccv_r28; 
load ccv_r29; 
load ccv_r30; 
load ccv_r31; 
load ccv_r32; 
load ccv_r33; 
load ccv_r34; 
load ccv_r35; 
load ccv_r36; 
load ccv_r37; 
load ccv_r38; 
load ccv_r39; 
load ccv_r40; 
load ccv_r41; 
load ccv_r42; 
load ccv_r43; 
load ccv_r44; 
load ccv_r45; 
load ccv_r46; 
load ccv_r47; 
load ccv_r48; 
load ccv_r49; 
load ccv_r50; 
load ccv_r51; 
load ccv_r52; 
load ccv_r53; 
load ccv_r54; 
load ccv_r55; 
load ccv_r56; 
load ccv_r57; 
load ccv_r58; 
load ccv_r59; 
load ccv_r60; 
load ccv_r61; 
load ccv_r62; 
load ccv_r63; 
load ccv_r64; 
load ccv_r65; 
load ccv_r66; 
load ccv_r67; 
load ccv_r68; 
load ccv_r69; 
load ccv_r70; 
load ccv_r71; 
load ccv_r72; 
load ccv_r73; 
load ccv_r74; 
load ccv_r75; 
load ccv_r76; 
load ccv_r77; 
load ccv_r78; 
load ccv_r79; 
load ccv_r80; 
load ccv_r81; 
load ccv_r82; 
load ccv_r83; 
load ccv_r84; 
load ccv_r85; 
load ccv_r86; 
load ccv_r87; 
load ccv_r88; 
load ccv_r89; 
load ccv_r90; 
load ccv_r91; 
load ccv_r92; 
load ccv_r93; 
load ccv_r94; 
load ccv_r95; 
load ccv_r96; 
load ccv_r97; 
load ccv_r98; 
load ccv_r99; 
load ccv_r100;
load ccv_r101;
load ccv_r102;
load ccv_r103;
load ccv_r104;
load ccv_r105;
load ccv_r106;
load ccv_r107;
load ccv_r108;
load ccv_r109;
load ccv_r110;
load ccv_r111;
load ccv_r112;
load ccv_r113;
load ccv_r114;



load ccv_s1; 
load ccv_s2; 
load ccv_s3; 
load ccv_s4; 
load ccv_s5; 
load ccv_s6; 
load ccv_s7; 
load ccv_s8; 
load ccv_s9; 
load ccv_s10;
load ccv_s11;
load ccv_s12;
load ccv_s13;
load ccv_s14;
load ccv_s15;
load ccv_s16;
load ccv_s17;
load ccv_s18;
load ccv_s19;
load ccv_s20;
load ccv_s21;
load ccv_s22;
load ccv_s23;
load ccv_s24;
load ccv_s25;
load ccv_s26;
load ccv_s27;
load ccv_s28;
load ccv_s29;
load ccv_s30;
load ccv_s31;
load ccv_s32;
load ccv_s33;
load ccv_s34;
load ccv_s35;
load ccv_s36;
load ccv_s37;
load ccv_s38;
load ccv_s39;
load ccv_s40;
load ccv_s41;
load ccv_s42;
load ccv_s43;
load ccv_s44;
load ccv_s45;
load ccv_s46;
load ccv_s47;
load ccv_s48;
load ccv_s49;
load ccv_s50;
load ccv_s51;
load ccv_s52;
load ccv_s53;
load ccv_s54;
load ccv_s55;
load ccv_s56;
load ccv_s57;
load ccv_s58;
load ccv_s59;
load ccv_s60;
load ccv_s61;
load ccv_s62;
load ccv_s63;
load ccv_s64;
load ccv_s65;
load ccv_s66;
load ccv_s67;
load ccv_s68;
load ccv_s69;
load ccv_s70;
load ccv_s71;
load ccv_s72;
load ccv_s73;
load ccv_s74;
load ccv_s75;
load ccv_s76;
load ccv_s77;
load ccv_s78;
load ccv_s79;
load ccv_s80;
load ccv_s81;
load ccv_s82;


T = [ccv_n1;ccv_n2;ccv_n3;ccv_n4;ccv_n5;ccv_n6;ccv_n7;ccv_n8;ccv_n9;ccv_n10;ccv_n11;ccv_n12;ccv_n13;ccv_n14;ccv_n15;ccv_n16;ccv_n17;ccv_n18;ccv_n19;ccv_n20;ccv_n21;ccv_n22;ccv_n23;ccv_n24;ccv_n25;ccv_n26;ccv_n27;ccv_n28;ccv_n29;ccv_n30;ccv_n31;ccv_n32;ccv_n33;ccv_n34;ccv_n35;ccv_n36;ccv_n37;ccv_n38;ccv_n39;ccv_n40;ccv_n41;ccv_n42;ccv_n43;ccv_n44;ccv_n45;ccv_n46;ccv_n47;ccv_n48;ccv_n49;ccv_n50;ccv_n51;ccv_n52;ccv_n53;ccv_n54;ccv_n55;ccv_n56;ccv_n57;ccv_n58;ccv_n59;ccv_n60;ccv_n61;ccv_n62;ccv_n63;ccv_n64;ccv_n65;ccv_n66;ccv_n67;ccv_n68;ccv_n69;ccv_n70;ccv_n71;ccv_n72;ccv_n73;ccv_n74;ccv_n75;ccv_n76;ccv_n77;ccv_n78;ccv_n79;ccv_b1;ccv_b2;ccv_b3;ccv_b4;ccv_b5;ccv_b6;ccv_b7;ccv_b8;ccv_b9;ccv_b10;ccv_b11;ccv_b12;ccv_b13;ccv_b14;ccv_b15;ccv_b16;ccv_b17;ccv_b18;ccv_b19;ccv_b20;ccv_b21;ccv_b22;ccv_b23;ccv_b24;ccv_b25;ccv_b26;ccv_b27;ccv_b28;ccv_b29;ccv_b30;ccv_b31;ccv_b32;ccv_b33;ccv_b34;ccv_b35;ccv_b36;ccv_b37;ccv_b38;ccv_b39;ccv_b40;ccv_b41;ccv_b42;ccv_b43;ccv_b44;ccv_b45;ccv_b46;ccv_b47;ccv_b48;ccv_b49;ccv_b50;ccv_b51;ccv_b52;ccv_b53;ccv_b54;ccv_b55;ccv_b56;ccv_b57;ccv_b58;ccv_b59;ccv_b60;ccv_b61;ccv_b62;ccv_b63;ccv_b64;ccv_b65;ccv_b66;ccv_b67;ccv_b68;ccv_b69;ccv_b70;ccv_b71;ccv_b72;ccv_b73;ccv_b74;ccv_b75;ccv_b76;ccv_b77;ccv_b78;ccv_b79;ccv_b80;ccv_b81;ccv_b82;ccv_b83;ccv_b84;ccv_b85;ccv_b86;ccv_b87;ccv_b88;ccv_b89;ccv_b90;ccv_b91;ccv_b92;ccv_b93;ccv_b94;ccv_b95;ccv_b96;ccv_b97;ccv_b98;ccv_b99;ccv_b100;ccv_b101;ccv_b102;ccv_b103;ccv_b104;ccv_b105;ccv_b106;ccv_b107;ccv_b108;ccv_b109;ccv_b110;ccv_b111;ccv_b112;ccv_b113;ccv_b114;ccv_b115;ccv_b116;ccv_b117;ccv_b118;ccv_b119;ccv_b120;ccv_b121;ccv_r1;ccv_r2;ccv_r3;ccv_r4;ccv_r5;ccv_r6;ccv_r7;ccv_r8;ccv_r9;ccv_r10;ccv_r11;ccv_r12;ccv_r13;ccv_r14;ccv_r15;ccv_r16;ccv_r17;ccv_r18;ccv_r19;ccv_r20;ccv_r21;ccv_r22;ccv_r23;ccv_r24;ccv_r25;ccv_r26;ccv_r27;ccv_r28;ccv_r29;ccv_r30;ccv_r31;ccv_r32;ccv_r33;ccv_r34;ccv_r35;ccv_r36;ccv_r37;ccv_r38;ccv_r39;ccv_r40;ccv_r41;ccv_r42;ccv_r43;ccv_r44;ccv_r45;ccv_r46;ccv_r47;ccv_r48;ccv_r49;ccv_r50;ccv_r51;ccv_r52;ccv_r53;ccv_r54;ccv_r55;ccv_r56;ccv_r57;ccv_r58;ccv_r59;ccv_r60;ccv_r61;ccv_r62;ccv_r63;ccv_r64;ccv_r65;ccv_r66;ccv_r67;ccv_r68;ccv_r69;ccv_r70;ccv_r71;ccv_r72;ccv_r73;ccv_r74;ccv_r75;ccv_r76;ccv_r77;ccv_r78;ccv_r79;ccv_r80;ccv_r81;ccv_r82;ccv_r83;ccv_r84;ccv_r85;ccv_r86;ccv_r87;ccv_r88;ccv_r89;ccv_r90;ccv_r91;ccv_r92;ccv_r93;ccv_r94;ccv_r95;ccv_r96;ccv_r97;ccv_r98;ccv_r99;ccv_r100;ccv_r101;ccv_r102;ccv_r103;ccv_r104;ccv_r105;ccv_r106;ccv_r107;ccv_r108;ccv_r109;ccv_r110;ccv_r111;ccv_r112;ccv_r113;ccv_r114;ccv_s1;ccv_s2;ccv_s3;ccv_s4;ccv_s5;ccv_s6;ccv_s7;ccv_s8;ccv_s9;ccv_s10;ccv_s11;ccv_s12;ccv_s13;ccv_s14;ccv_s15;ccv_s16;ccv_s17;ccv_s18;ccv_s19;ccv_s20;ccv_s21;ccv_s22;ccv_s23;ccv_s24;ccv_s25;ccv_s26;ccv_s27;ccv_s28;ccv_s29;ccv_s30;ccv_s31;ccv_s32;ccv_s33;ccv_s34;ccv_s35;ccv_s36;ccv_s37;ccv_s38;ccv_s39;ccv_s40;ccv_s41;ccv_s42;ccv_s43;ccv_s44;ccv_s45;ccv_s46;ccv_s47;ccv_s48;ccv_s49;ccv_s50;ccv_s51;ccv_s52;ccv_s53;ccv_s54;ccv_s55;ccv_s56;ccv_s57;ccv_s58;ccv_s59;ccv_s60;ccv_s61;ccv_s62;ccv_s63;ccv_s64;ccv_s65;ccv_s66;ccv_s67;ccv_s68;ccv_s69;ccv_s70;ccv_s71;ccv_s72;ccv_s73;ccv_s74;ccv_s75;ccv_s76;ccv_s77;ccv_s78;ccv_s79;ccv_s80;ccv_s81;ccv_s82];
  train_lab = imageDatastore("C:\Users\amesj\Desktop\Tesi\Mycode_test_update\DB_Train\*","FileExtensions",[".jpg",".tif"],'LabelSource','foldernames');
   label=train_lab.Labels;
   C = cellstr(label)

t = templateSVM('Standardize',true,'KernelFunction','gaussian');

X = T;
Y = C;

Mdl = fitcecoc(X,Y,'Learners',t,'FitPosterior',true,...
    'ClassNames',{'Blotch_Apple','Normal_Apple','Rot_Apple','Scab_Apple'},...
    'Verbose',2);

% Mdl = fitcecoc(T,C)% Train a multiclass ECOC model using the default options
 Mdl.ClassNames  %Display the class names and the coding design matrix.
 %CodingMat = Mdl.CodingMatrix
 error = resubLoss(Mdl) % Compute the resubstitution classification error.

 [label,~,~,Posterior] = resubPredict(Mdl,'Verbose',1);
 idx = randsample(size(X,1),10,1);
 
 table(Y(idx),label(idx),Posterior(idx,:),...
    'VariableNames',{'TrueLabel','PredLabel','Posterior : |Blotch_Apple|Normal_Apple|Rot_Apple|Scab_Apple|'})



%x=[0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3];




